<body>
    <div class="register-container">
        <div class="progress-container">
            <div class="progress-steps">
                <div class="progress-line">
                    <div class="progress-line-fill" id="progressLine"></div>
                </div>
                <div class="step active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Hesap Türü</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Bilgiler</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Onay</div>
                </div>
            </div>
        </div>

        <div class="content-container">
            <!-- Step 1: Hesap Türü Seçimi -->
            <div class="step-content active" id="step1">
                <div class="user-types">
                    <div class="user-type" onclick="selectUserType('uretici')">
                        <div class="user-type-icon">
                            <i class="fas fa-industry"></i>
                        </div>
                        <h3>Üretici</h3>
                        <p>Üretim kapasitenizi sergileyin, yeni müşterilere ulaşın ve işinizi büyütün</p>
                    </div>
                    <div class="user-type" onclick="selectUserType('profesyonel')">
                        <div class="user-type-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3>Profesyonel</h3>
                        <p>Güvenilir üreticilere ulaşın, teklifler alın ve projelerinizi hayata geçirin</p>
                    </div>
                </div>
            </div>

            <!-- Step 2: Form -->
            <div class="step-content" id="step2">
                <form id="registrationForm" onsubmit="handleSubmit(event)">
                    <!-- Form fields will be dynamically loaded -->
                </form>
            </div>

            <!-- Step 3: Onay -->
            <div class="step-content" id="step3">
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i>
                    Hesabınız başarıyla oluşturuldu! Lütfen e-posta adresinizi kontrol edin.
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedType = '';

        function updateProgress(step) {
            const progress = ((step - 1) / 2) * 100;
            document.getElementById('progressLine').style.width = `${progress}%`;

            // Update steps
            document.querySelectorAll('.step').forEach(el => {
                const stepNum = parseInt(el.dataset.step);
                el.classList.remove('active', 'completed');
                if (stepNum === step) {
                    el.classList.add('active');
                } else if (stepNum < step) {
                    el.classList.add('completed');
                }
            });
        }

        function selectUserType(type) {
            selectedType = type;
            document.querySelectorAll('.user-type').forEach(el => {
                el.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            setTimeout(() => {
                goToStep(2);
                loadForm(type);
            }, 400);
        }

        function loadForm(type) {
            const form = document.getElementById('registrationForm');
            const fields = type === 'uretici' ? getUreticiFields() : getProfesyonelFields();
            
            form.innerHTML = fields + `
                <div class="buttons">
                    <button type="button" class="btn btn-outline" onclick="goToStep(1)">
                        <i class="fas fa-arrow-left"></i>
                        Geri
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-check"></i>
                        Devam Et
                    </button>
                </div>
            `;
        }

        function getUreticiFields() {
            return `
                <div class="form-group">
                    <label class="form-label">Firma Adı*</label>
                    <input type="text" name="companyName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Vergi Numarası*</label>
                    <input type="text" name="taxNumber" class="form-input" required pattern="[0-9]{10}">
                </div>
                <div class="form-group">
                    <label class="form-label">Yetkili Ad Soyad*</label>
                    <input type="text" name="fullName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">E-posta*</label>
                    <input type="email" name="email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Şifre*</label>
                    <input type="password" name="password" class="form-input" required minlength="6">
                </div>
            `;
        }

        function getProfesyonelFields() {
            return `
                <div class="form-group">
                    <label class="form-label">Ad Soyad*</label>
                    <input type="text" name="fullName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">E-posta*</label>
                    <input type="email" name="email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Şifre*</label>
                    <input type="password" name="password" class="form-input" required minlength="6">
                </div>
            `;
        }

        async function handleSubmit(e) {
            e.preventDefault();
            const form = e.target;
            const submitButton = form.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> İşleniyor...';

            try {
                const formData = new FormData(form);
                const response = await fetch('https://eticaret-glif.onrender.com/api/manufacturer/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(Object.fromEntries(formData))
                });

                const data = await response.json();

                if (response.ok) {
                    goToStep(3);
                } else {
                    showError(data.message || 'Bir hata oluştu');
                }
            } catch (error) {
                showError('Sunucu ile bağlantı kurulamadı');
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-check"></i> Devam Et';
            }
        }

        function showError(message) {
            const alert = document.createElement('div');
            alert.className = 'alert alert-error';
            alert.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
            document.querySelector('.step-content.active').insertBefore(
                alert,
                document.querySelector('.step-content.active').firstChild
            );
            setTimeout(() => alert.remove(), 5000);
        }

        function goToStep(step) {
            document.querySelectorAll('.step-content').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById(`step${step}`).classList.add('active');
            currentStep = step;
            updateProgress(step);
        }
    </script>
</body>
</html>
<body>
    <div class="register-container">
        <div class="progress-container">
            <div class="progress-steps">
                <div class="progress-line">
                    <div class="progress-line-fill" id="progressLine"></div>
                </div>
                <div class="step active" data-step="1">
                    <div class="step-circle">1</div>
                    <div class="step-label">Hesap Türü</div>
                </div>
                <div class="step" data-step="2">
                    <div class="step-circle">2</div>
                    <div class="step-label">Bilgiler</div>
                </div>
                <div class="step" data-step="3">
                    <div class="step-circle">3</div>
                    <div class="step-label">Onay</div>
                </div>
            </div>
        </div>

        <div class="content-container">
            <!-- Step 1: Hesap Türü Seçimi -->
            <div class="step-content active" id="step1">
                <div class="user-types">
                    <div class="user-type" onclick="selectUserType('uretici')">
                        <div class="user-type-icon">
                            <i class="fas fa-industry"></i>
                        </div>
                        <h3>Üretici</h3>
                        <p>Üretim kapasitenizi sergileyin, yeni müşterilere ulaşın ve işinizi büyütün</p>
                    </div>
                    <div class="user-type" onclick="selectUserType('profesyonel')">
                        <div class="user-type-icon">
                            <i class="fas fa-user-tie"></i>
                        </div>
                        <h3>Profesyonel</h3>
                        <p>Güvenilir üreticilere ulaşın, teklifler alın ve projelerinizi hayata geçirin</p>
                    </div>
                </div>
            </div>

            <!-- Step 2: Form -->
            <div class="step-content" id="step2">
                <form id="registrationForm" onsubmit="handleSubmit(event)">
                    <!-- Form fields will be dynamically loaded -->
                </form>
            </div>

            <!-- Step 3: Onay -->
            <div class="step-content" id="step3">
                <div class="alert alert-success">
                    <i class="fas fa-check-circle"></i>
                    Hesabınız başarıyla oluşturuldu! Lütfen e-posta adresinizi kontrol edin.
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        let selectedType = '';

        function updateProgress(step) {
            const progress = ((step - 1) / 2) * 100;
            document.getElementById('progressLine').style.width = `${progress}%`;

            // Update steps
            document.querySelectorAll('.step').forEach(el => {
                const stepNum = parseInt(el.dataset.step);
                el.classList.remove('active', 'completed');
                if (stepNum === step) {
                    el.classList.add('active');
                } else if (stepNum < step) {
                    el.classList.add('completed');
                }
            });
        }

        function selectUserType(type) {
            selectedType = type;
            document.querySelectorAll('.user-type').forEach(el => {
                el.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            setTimeout(() => {
                goToStep(2);
                loadForm(type);
            }, 400);
        }

        function loadForm(type) {
            const form = document.getElementById('registrationForm');
            const fields = type === 'uretici' ? getUreticiFields() : getProfesyonelFields();
            
            form.innerHTML = fields + `
                <div class="buttons">
                    <button type="button" class="btn btn-outline" onclick="goToStep(1)">
                        <i class="fas fa-arrow-left"></i>
                        Geri
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-check"></i>
                        Devam Et
                    </button>
                </div>
            `;
        }

        function getUreticiFields() {
            return `
                <div class="form-group">
                    <label class="form-label">Firma Adı*</label>
                    <input type="text" name="companyName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Vergi Numarası*</label>
                    <input type="text" name="taxNumber" class="form-input" required pattern="[0-9]{10}">
                </div>
                <div class="form-group">
                    <label class="form-label">Yetkili Ad Soyad*</label>
                    <input type="text" name="fullName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">E-posta*</label>
                    <input type="email" name="email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Şifre*</label>
                    <input type="password" name="password" class="form-input" required minlength="6">
                </div>
            `;
        }

        function getProfesyonelFields() {
            return `
                <div class="form-group">
                    <label class="form-label">Ad Soyad*</label>
                    <input type="text" name="fullName" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">E-posta*</label>
                    <input type="email" name="email" class="form-input" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Şifre*</label>
                    <input type="password" name="password" class="form-input" required minlength="6">
                </div>
            `;
        }

        async function handleSubmit(e) {
            e.preventDefault();
            const form = e.target;
            const submitButton = form.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> İşleniyor...';

            try {
                const formData = new FormData(form);
                const response = await fetch('https://eticaret-glif.onrender.com/api/manufacturer/auth/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(Object.fromEntries(formData))
                });

                const data = await response.json();

                if (response.ok) {
                    goToStep(3);
                } else {
                    showError(data.message || 'Bir hata oluştu');
                }
            } catch (error) {
                showError('Sunucu ile bağlantı kurulamadı');
            } finally {
                submitButton.disabled = false;
                submitButton.innerHTML = '<i class="fas fa-check"></i> Devam Et';
            }
        }

        function showError(message) {
            const alert = document.createElement('div');
            alert.className = 'alert alert-error';
            alert.innerHTML = `<i class="fas fa-exclamation-circle"></i> ${message}`;
            document.querySelector('.step-content.active').insertBefore(
                alert,
                document.querySelector('.step-content.active').firstChild
            );
            setTimeout(() => alert.remove(), 5000);
        }

        function goToStep(step) {
            document.querySelectorAll('.step-content').forEach(el => {
                el.classList.remove('active');
            });
            document.getElementById(`step${step}`).classList.add('active');
            currentStep = step;
            updateProgress(step);
        }
    </script>
</body>
</html>
