<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Üretici Portal - IndustryHub</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Toastify CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    
    <!-- Aynı CSS kodları buraya gelecek -->
    <style>
        /* Önceki CSS kodlarının tamamı buraya gelecek */
    </style>
</head>
<body>
    <div class="container">
        <div class="auth-container">
            <div class="auth-image">
                <div class="image-content">
                    <h2>IndustryHub</h2>
                    <p>Üreticiler için Profesyonel Platform</p>
                </div>
            </div>
            <div class="auth-forms">
                <!-- Login Form -->
                <div class="form-container active" id="loginForm">
                    <div class="form-header">
                        <h3>Giriş Yap</h3>
                        <p>Üretici hesabınıza giriş yapın</p>
                    </div>
                    <form onsubmit="return handleLogin(event)">
                        <div class="form-group">
                            <label for="loginEmail">E-posta</label>
                            <input type="email" id="loginEmail" required>
                            <i class="fas fa-envelope" style="position: absolute; right: 12px; top: 38px; color: rgba(255,255,255,0.6);"></i>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">Şifre</label>
                            <input type="password" id="loginPassword" required>
                            <i class="fas fa-eye toggle-password" onclick="togglePasswordVisibility('loginPassword', this)"></i>
                        </div>
                        <button type="submit" class="auth-button">
                            <span>Giriş Yap</span>
                            <div class="spinner"></div>
                        </button>
                        <div class="form-footer">
                            <p>Hesabınız yok mu? <span class="form-switch" onclick="toggleForm()">Kayıt Ol</span></p>
                        </div>
                        <div class="social-login">
                            <p>Veya şununla giriş yapın:</p>
                            <div class="social-buttons">
                                <div class="social-button" onclick="handleSocialLogin('linkedin')">
                                    <i class="fab fa-linkedin-in"></i>
                                </div>
                                <div class="social-button" onclick="handleSocialLogin('google')">
                                    <i class="fab fa-google"></i>
                                </div>
                                <div class="social-button" onclick="handleSocialLogin('github')">
                                    <i class="fab fa-github"></i>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- Signup Form -->
                <div class="form-container" id="signupForm">
                    <div class="form-header">
                        <h3>Kayıt Ol</h3>
                        <p>Üretici hesabınızı oluşturun</p>
                    </div>
                    <form onsubmit="return handleSignup(event)">
                        <div class="form-group">
                            <label for="companyName">Şirket Adı</label>
                            <input type="text" id="companyName" required>
                            <i class="fas fa-building" style="position: absolute; right: 12px; top: 38px; color: rgba(255,255,255,0.6);"></i>
                        </div>
                        <div class="form-group">
                            <label for="taxNumber">Vergi Numarası</label>
                            <input type="text" id="taxNumber" required pattern="\d{10}" title="Vergi numarası 10 haneli olmalıdır">
                            <i class="fas fa-receipt" style="position: absolute; right: 12px; top: 38px; color: rgba(255,255,255,0.6);"></i>
                        </div>
                        <div class="form-group">
                            <label for="businessArea">Faaliyet Alanı</label>
                            <select id="businessArea" required>
                                <option value="">Seçiniz</option>
                                <option value="furniture">Mobilya</option>
                                <option value="textile">Tekstil</option>
                                <option value="construction">İnşaat Malzemeleri</option>
                                <option value="electronics">Elektronik</option>
                                <option value="automotive">Otomotiv</option>
                                <option value="other">Diğer</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="address">Şirket Adresi</label>
                            <input type="text" id="address" required>
                            <i class="fas fa-map-marker-alt" style="position: absolute; right: 12px; top: 38px; color: rgba(255,255,255,0.6);"></i>
                        </div>
                        <div class="form-group">
                            <label for="contactName">Yetkili Kişi</label>
                            <input type="text" id="contactName" required>
                            <i class="fas fa-user" style="position: absolute; right: 12px; top: 38px; color: rgba(255,255,255,0.6);"></i>
                        </div>
                        <div class="form-group">
                            <label for="signupEmail">E-posta</label>
                            <input type="email" id="signupEmail" required>
                            <i class="fas fa-envelope" style="position: absolute; right: 12px; top: 38px; color: rgba(255,255,255,0.6);"></i>
                        </div>
                        <div class="form-group">
                            <label for="signupPassword">Şifre</label>
                            <input type="password" id="signupPassword" required onkeyup="checkPasswordStrength(this.value)">
                            <i class="fas fa-eye toggle-password" onclick="togglePasswordVisibility('signupPassword', this)"></i>
                            <div class="password-strength">
                                <div class="password-strength-bar"></div>
                            </div>
                        </div>
                        <div class="file-upload">
                            <label>Şirket Belgeleri (Vergi Levhası, Ticaret Sicil Gazetesi vb.)</label>
                            <div class="file-input-wrapper">
                                <input type="file" id="companyDocs" accept=".pdf,.jpg,.jpeg,.png" multiple onchange="handleFileSelect(event)" required>
                                <label for="companyDocs" class="file-upload-btn">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                    <span>Dosya Seç veya Sürükle Bırak</span>
                                </label>
                                <div class="file-name" id="fileName"></div>
                            </div>
                        </div>
                        <button type="submit" class="auth-button">
                            <span>Kayıt Ol</span>
                            <div class="spinner"></div>
                        </button>
                        <div class="form-footer">
                            <p>Zaten hesabınız var mı? <span class="form-switch" onclick="toggleForm()">Giriş Yap</span></p>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Toastify JS -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script>
    const API_URL = 'https://eticaret-glif.onrender.com/api';

    // Toast Bildirimleri için Yardımcı Fonksiyon
    function showToast(message, type = 'success') {
        Toastify({
            text: message,
            duration: 3000,
            gravity: "top",
            position: "right",
            stopOnFocus: true,
            style: {
                background: type === 'success' ? "linear-gradient(to right, #00b09b, #96c93d)" : 
                           type === 'error' ? "linear-gradient(to right, #ff5f6d, #ffc371)" : 
                           "linear-gradient(to right, #00b09b, #96c93d)",
            }
        }).showToast();
    }

    // Sayfa Yüklendiğinde
    document.addEventListener('DOMContentLoaded', () => {
        const token = localStorage.getItem('token');
        if (token) {
            window.location.href = 'https://enigma0x1.github.io/eticaret-frontend/dashboard.html';
        }
        initializeFileUpload();
    });

    // Form Toggle
    function toggleForm() {
        document.getElementById('loginForm').classList.toggle('active');
        document.getElementById('signupForm').classList.toggle('active');
    }

    // Şifre Görünürlüğü Toggle
    function togglePasswordVisibility(inputId, icon) {
        const input = document.getElementById(inputId);
        if (input.type === 'password') {
            input.type = 'text';
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
        } else {
            input.type = 'password';
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
        }
    }

    // Şifre Gücü Kontrolü
    function checkPasswordStrength(password) {
        const strengthBar = document.querySelector('.password-strength-bar');
        let strength = 0;
        
        if (password.match(/[a-z]+/)) strength += 1;
        if (password.match(/[A-Z]+/)) strength += 1;
        if (password.match(/[0-9]+/)) strength += 1;
        if (password.match(/[$@#&!]+/)) strength += 1;
        if (password.length >= 8) strength += 1;

        strengthBar.style.width = (strength * 20) + '%';
        
        switch(strength) {
            case 0:
            case 1:
                strengthBar.style.backgroundColor = '#ff4d4d';
                break;
            case 2:
                strengthBar.style.backgroundColor = '#ffd700';
                break;
            case 3:
                strengthBar.style.backgroundColor = '#ffb900';
                break;
            case 4:
                strengthBar.style.backgroundColor = '#00ff00';
                break;
            case 5:
                strengthBar.style.backgroundColor = '#00cc00';
                break;
        }
    }

    // Dosya Yükleme İşlemleri
    function initializeFileUpload() {
        const dropZone = document.querySelector('.file-input-wrapper');
        const fileInput = document.getElementById('companyDocs');

        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            dropZone.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            dropZone.addEventListener(eventName, unhighlight, false);
        });

        function highlight(e) {
            dropZone.classList.add('highlight');
        }

        function unhighlight(e) {
            dropZone.classList.remove('highlight');
        }

        dropZone.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            fileInput.files = files;
            handleFileSelect({ target: fileInput });
        }
    }

    function handleFileSelect(event) {
        const fileNameElement = document.getElementById('fileName');
        const files = event.target.files;
        
        if (files.length > 0) {
            if (files.length === 1) {
                fileNameElement.textContent = files[0].name;
            } else {
                fileNameElement.textContent = `${files.length} dosya seçildi`;
            }
        } else {
            fileNameElement.textContent = '';
        }
    }

    // Login İşlemi
    async function handleLogin(event) {
        event.preventDefault();
        
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        const button = event.target.querySelector('button');
        
        button.classList.add('loading');
        
        try {
            const response = await fetch(`${API_URL}/auth/login`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    email,
                    password,
                    userType: 'manufacturer'
                })
            });

            const data = await response.json();

            if (response.ok) {
                localStorage.setItem('token', data.token);
                localStorage.setItem('user', JSON.stringify(data.user));
                
                showToast('Giriş başarılı! Yönlendiriliyorsunuz...', 'success');
                
                setTimeout(() => {
                    window.location.href = 'https://enigma0x1.github.io/eticaret-frontend/dashboard.html';
                }, 1500);
            } else {
                showToast(data.message || 'Giriş başarısız!', 'error');
            }
        } catch (error) {
            showToast('Bir hata oluştu!', 'error');
        } finally {
            button.classList.remove('loading');
        }
    }

    // Signup İşlemi
    async function handleSignup(event) {
        event.preventDefault();
        
        const companyName = document.getElementById('companyName').value;
        const taxNumber = document.getElementById('taxNumber').value;
        const businessArea = document.getElementById('businessArea').value;
        const address = document.getElementById('address').value;
        const contactName = document.getElementById('contactName').value;
        const email = document.getElementById('signupEmail').value;
        const password = document.getElementById('signupPassword').value;
        const companyDocs = document.getElementById('companyDocs').files;
        
        const button = event.target.querySelector('button');
        button.classList.add('loading');

        const formData = new FormData();
        formData.append('companyName', companyName);
        formData.append('taxNumber', taxNumber);
        formData.append('businessArea', businessArea);
        formData.append('address', address);
        formData.append('contactName', contactName);
        formData.append('email', email);
        formData.append('password', password);
        formData.append('userType', 'manufacturer');

        for (let i = 0; i < companyDocs.length; i++) {
            formData.append('companyDocs', companyDocs[i]);
        }

        try {
            const response = await fetch(`${API_URL}/auth/register`, {
                method: 'POST',
                body: formData
            });

            const data = await response.json();

            if (response.ok) {
                showToast('Kayıt başarılı! Giriş yapabilirsiniz.', 'success');
                toggleForm();
            } else {
                showToast(data.message || 'Kayıt başarısız!', 'error');
            }
        } catch (error) {
            showToast('Bir hata oluştu!', 'error');
        } finally {
            button.classList.remove('loading');
        }
    }

    // Sosyal Medya ile Giriş
    function handleSocialLogin(platform) {
        showToast(`${platform} ile giriş yakında aktif olacak!`, 'info');
    }
</script>
</body>
</html>
