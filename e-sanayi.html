<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Sanayi - Sanayi İşletmeleri</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        html, body {
            overscroll-behavior: none;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }

        body {
            background-color: #f4f4f4;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Top Bar Styles */
        .top-bar {
            background: #333;
            color: white;
            padding: 8px 0;
            font-size: 13px;
        }

        .top-bar .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .top-contact a {
            color: white;
            text-decoration: none;
            margin-right: 20px;
            transition: 0.3s;
        }

        .top-contact a:hover {
            color: #FF5722;
        }

        .social-links a {
            color: white;
            margin-left: 15px;
            transition: 0.3s;
        }

        .social-links a:hover {
            color: #FF5722;
        }

        /* Header Styles */
        .header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-top {
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo a {
            font-size: 24px;
            color: #333;
            text-decoration: none;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            color: #FF5722;
        }

        .search-bar {
            flex: 1;
            max-width: 600px;
            margin: 0 30px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid #eee;
            border-radius: 30px;
            font-size: 14px;
            transition: 0.3s;
        }

        .search-bar input:focus {
            border-color: #FF5722;
            outline: none;
        }

        .search-bar button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: #FF5722;
            border: none;
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: 0.3s;
        }

        .search-bar button:hover {
            background: #f4511e;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-actions a {
            text-decoration: none;
            color: #666;
            font-size: 14px;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .user-actions a:hover {
            color: #FF5722;
        }

        .btn-primary {
            background: #FF5722;
            color: white !important;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 500;
        }

        .btn-primary:hover {
            background: #f4511e;
        }

        /* Mega Menu Styles */
        .mega-menu {
            background: white;
            border-bottom: 1px solid #eee;
            padding: 0;
        }

        .category-nav {
            display: flex;
            justify-content: space-between;
            position: relative;
        }

        .category-item {
            position: relative;
            padding: 15px 20px;
            cursor: pointer;
        }

        .category-item > a {
            color: #333;
            text-decoration: none;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .category-item:hover {
            background: #f8f8f8;
        }

        .category-item:hover .submenu {
            display: flex;
        }

        .submenu {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            padding: 20px;
            z-index: 1000;
        }

        .submenu-column {
            flex: 1;
            padding: 0 15px;
        }

        .submenu-title {
            font-weight: bold;
            color: #FF5722;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .submenu-list {
            list-style: none;
        }

        .submenu-list li {
            margin-bottom: 8px;
        }

        .submenu-list a {
            color: #666;
            text-decoration: none;
            font-size: 13px;
            transition: 0.3s;
        }

        .submenu-list a:hover {
            color: #FF5722;
        }
	        /* Main Content Styles */
        .main-content {
            padding: 30px 0;
            display: flex;
            gap: 30px;
        }

        /* Filter Sidebar Styles */
        .filters {
            width: 300px;
            flex-shrink: 0;
        }

        .filter-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            overflow: hidden;
        }

        .filter-header {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .filter-header h3 {
            font-size: 15px;
            color: #333;
            font-weight: 500;
        }

        .filter-content {
            padding: 15px 20px;
        }

        .filter-group {
            margin-bottom: 15px;
        }

        .filter-group:last-child {
            margin-bottom: 0;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .checkbox-item label {
            font-size: 14px;
            color: #666;
            cursor: pointer;
        }

        .range-slider {
            width: 100%;
            margin: 10px 0;
        }

        /* Content Area Styles */
        .content-area {
            flex: 1;
        }

        .content-header {
            background: white;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .filter-tag {
            background: #f8f8f8;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 13px;
            color: #666;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .filter-tag i {
            cursor: pointer;
            color: #999;
        }

        .filter-tag i:hover {
            color: #FF5722;
        }

        .sort-options {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .sort-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            color: #666;
        }

        .view-options {
            display: flex;
            gap: 5px;
        }

        .view-btn {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            cursor: pointer;
            color: #666;
            transition: 0.3s;
        }

        .view-btn.active {
            background: #FF5722;
            color: white;
            border-color: #FF5722;
        }

        /* Company Card Styles */
        .company-list {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .company-card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            overflow: hidden;
            transition: 0.3s;
        }

        .company-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .company-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }

        .company-title {
            font-size: 18px;
            color: #2196F3;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .company-specs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .spec-item {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .spec-label {
            font-size: 13px;
            color: #666;
            font-weight: 500;
        }

        .spec-value {
            font-size: 14px;
            color: #333;
        }

        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .machine-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 13px;
        }

        .cert-tag {
            background: #e8f5e9;
            color: #2e7d32;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 13px;
        }

        .company-footer {
            padding: 15px 20px;
            background: #f8f8f8;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .company-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .company-logo {
            width: 50px;
            height: 50px;
            border-radius: 4px;
            object-fit: cover;
        }

        .company-details {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .company-name {
            font-size: 14px;
            color: #333;
        }

        .company-location {
            font-size: 13px;
            color: #666;
        }

        .company-rating {
            font-size: 13px;
            color: #ffa000;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .action-btn {
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            cursor: pointer;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .btn-quote {
            background: #FF5722;
            color: white;
            border: none;
        }

        .btn-contact {
            background: white;
            border: 1px solid #FF5722;
            color: #FF5722;
        }

        .btn-favorite {
            width: 36px;
            height: 36px;
            border: 1px solid #ddd;
            background: white;
            color: #666;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
        }

        .btn-favorite.active {
            color: #FF5722;
            border-color: #FF5722;
        }
	        /* Pagination Styles */
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 30px;
            gap: 5px;
        }

        .pagination button {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            color: #666;
            cursor: pointer;
            transition: 0.3s;
            border-radius: 4px;
        }

        .pagination button.active {
            background: #FF5722;
            color: white;
            border-color: #FF5722;
        }

        .pagination button:hover:not(.active) {
            background: #f8f8f8;
        }

        /* Responsive Styles */
        @media (max-width: 1200px) {
            .container {
                padding: 0 20px;
            }
        }

        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }

            .filters {
                width: 100%;
            }

            .company-specs {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            .search-bar {
                margin: 15px 0;
                max-width: 100%;
            }

            .company-footer {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .company-info {
                flex-direction: column;
            }

            .action-buttons {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 576px) {
            .company-specs {
                grid-template-columns: 1fr;
            }

            .sort-options {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="top-bar">
        <div class="container">
            <div class="top-contact">
                <a href="tel:+902121234567"><i class="fas fa-phone"></i> +90 212 123 45 67</a>
                <a href="mailto:info@esanayi.com"><i class="fas fa-envelope"></i> info@esanayi.com</a>
            </div>
            <div class="social-links">
                <a href="#"><i class="fab fa-facebook"></i></a>
                <a href="#"><i class="fab fa-twitter"></i></a>
                <a href="#"><i class="fab fa-linkedin"></i></a>
                <a href="#"><i class="fab fa-instagram"></i></a>
            </div>
        </div>
    </div>

    <header class="header">
        <div class="header-top">
            <div class="container">
                <div class="header-content">
                    <div class="logo">
                        <a href="/"><i class="fas fa-industry"></i> E-Sanayi</a>
                    </div>
                    <div class="search-bar">
                        <input type="text" placeholder="İhtiyacınız olan üretim/işleme kapasitesini arayın...">
                        <button><i class="fas fa-search"></i> Ara</button>
                    </div>
                    <div class="user-actions">
                        <a href="/giris"><i class="fas fa-user"></i> Giriş Yap</a>
                        <a href="/kayit"><i class="fas fa-user-plus"></i> Üye Ol</a>
                        <a href="/ilan-ver" class="btn-primary"><i class="fas fa-plus"></i> İşletme Ekle</a>
                    </div>
                </div>
            </div>
        </div>

        <nav class="mega-menu">
            <div class="container">
                <div class="category-nav">
                    <div class="category-item">
                        <a href="#">Metal İşleme <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <div class="submenu-column">
                                <div class="submenu-title">CNC İşleme</div>
                                <ul class="submenu-list">
                                    <li><a href="#">CNC Torna</a></li>
                                    <li><a href="#">CNC Freze</a></li>
                                    <li><a href="#">5 Eksen CNC</a></li>
                                    <li><a href="#">CNC Router</a></li>
                                </ul>
                            </div>
                            <div class="submenu-column">
                                <div class="submenu-title">Talaşlı İmalat</div>
                                <ul class="submenu-list">
                                    <li><a href="#">Universal Torna</a></li>
                                    <li><a href="#">Universal Freze</a></li>
                                    <li><a href="#">Taşlama</a></li>
                                    <li><a href="#">Planya</a></li>
                                </ul>
                            </div>
                            <div class="submenu-column">
                                <div class="submenu-title">Sac İşleme</div>
                                <ul class="submenu-list">
                                    <li><a href="#">Lazer Kesim</a></li>
                                    <li><a href="#">Plazma Kesim</a></li>
                                    <li><a href="#">Abkant Büküm</a></li>
                                    <li><a href="#">Giyotin Kesim</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="category-item">
                        <a href="#">Plastik İşleme <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <!-- Plastik işleme alt kategorileri -->
                        </div>
                    </div>

                    <div class="category-item">
                        <a href="#">Kalıp İmalatı <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <!-- Kalıp imalatı alt kategorileri -->
                        </div>
                    </div>

                    <div class="category-item">
                        <a href="#">Döküm <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <!-- Döküm alt kategorileri -->
                        </div>
                    </div>

                    <div class="category-item">
                        <a href="#">Elektronik <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <!-- Elektronik alt kategorileri -->
                        </div>
                    </div>

                    <div class="category-item">
                        <a href="#">Kaplama <i class="fas fa-chevron-down"></i></a>
                        <div class="submenu">
                            <!-- Kaplama alt kategorileri -->
                        </div>
                    </div>
                </div>
            </div>
        </nav>
    </header>
    <div class="container">
        <div class="main-content">
            <!-- Filtreler -->
            <aside class="filters">
                <div class="filter-card">
                    <div class="filter-header">
                        <h3>İşleme Kapasiteleri</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="cap1">
                                <label for="cap1">CNC İşleme (245)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cap2">
                                <label for="cap2">5 Eksen İşleme (124)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cap3">
                                <label for="cap3">Hassas Tornalama (189)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cap4">
                                <label for="cap4">Kalıp İmalatı (156)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cap5">
                                <label for="cap5">Tel Erozyon (78)</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filter-card">
                    <div class="filter-header">
                        <h3>İşlenebilen Malzemeler</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="mat1">
                                <label for="mat1">Çelik (312)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="mat2">
                                <label for="mat2">Paslanmaz Çelik (245)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="mat3">
                                <label for="mat3">Alüminyum (278)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="mat4">
                                <label for="mat4">Titanyum (89)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="mat5">
                                <label for="mat5">Plastik (167)</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filter-card">
                    <div class="filter-header">
                        <h3>Sertifikalar</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="cert1">
                                <label for="cert1">ISO 9001 (289)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cert2">
                                <label for="cert2">ISO 14001 (156)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cert3">
                                <label for="cert3">AS9100 (67)</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="cert4">
                                <label for="cert4">IATF 16949 (98)</label>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="filter-card">
                    <div class="filter-header">
                        <h3>Lokasyon</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <select class="sort-select">
                            <option>İl Seçiniz</option>
                            <option>İstanbul (456)</option>
                            <option>Ankara (234)</option>
                            <option>İzmir (189)</option>
                            <option>Bursa (167)</option>
                            <option>Kocaeli (145)</option>
                        </select>
                    </div>
                </div>
            </aside>

            <!-- İçerik Alanı -->
            <div class="content-area">
                <div class="content-header">
                    <div class="active-filters">
                        <div class="filter-tag">
                            CNC İşleme <i class="fas fa-times"></i>
                        </div>
                        <div class="filter-tag">
                            ISO 9001 <i class="fas fa-times"></i>
                        </div>
                        <div class="filter-tag">
                            İstanbul <i class="fas fa-times"></i>
                        </div>
                    </div>
                    <div class="sort-options">
                        <select class="sort-select">
                            <option>Sıralama</option>
                            <option>En Yeniler</option>
                            <option>En Çok Değerlendirilenler</option>
                            <option>Puanı En Yüksek</option>
                        </select>
                        <div class="view-options">
                            <button class="view-btn active"><i class="fas fa-list"></i></button>
                            <button class="view-btn"><i class="fas fa-th"></i></button>
                        </div>
                    </div>
                </div>

                <div class="company-list">
                    <!-- Firma Kartı 1 -->
                    <div class="company-card">
                        <div class="company-header">
                            <h2 class="company-title">5 Eksen CNC İşleme & Hassas Parça İmalatı</h2>
                            <div class="company-specs">
                                <div class="spec-item">
                                    <span class="spec-label">İşleme Kapasitesi</span>
                                    <span class="spec-value">Ø5mm - Ø500mm arası hassas işleme</span>
                                </div>
                                <div class="spec-item">
                                    <span class="spec-label">Hassasiyet</span>
                                    <span class="spec-value">±0.005mm tolerans</span>
                                </div>
                                <div class="spec-item">
                                    <span class="spec-label">İşlenebilen Malzemeler</span>
                                    <span class="spec-value">Çelik, Paslanmaz, Alüminyum, Titanyum</span>
                                </div>
                            </div>
                            <div class="tag-container">
                                <span class="machine-tag">5 Eksen CNC (3)</span>
                                <span class="machine-tag">CNC Torna (5)</span>
                                <span class="machine-tag">Tel Erozyon (2)</span>
                                <span class="machine-tag">CMM Ölçüm</span>
                                <span class="cert-tag">ISO 9001</span>
                                <span class="cert-tag">AS9100</span>
                            </div>
                        </div>
                        <div class="company-footer">
                            <div class="company-info">
                                <img src="https://via.placeholder.com/50" alt="Logo" class="company-logo">
                                <div class="company-details">
                                    <span class="company-name">Teknik Metal San.</span>
                                    <span class="company-location"><i class="fas fa-map-marker-alt"></i> İstanbul/Dudullu</span>
                                    <span class="company-rating"><i class="fas fa-star"></i> 4.8/5.0 (156 değerlendirme)</span>
                                </div>
                            </div>
                            <div class="action-buttons">
                                <button class="action-btn btn-quote"><i class="fas fa-file-alt"></i> Teklif Al</button>
                                <button class="action-btn btn-contact"><i class="fas fa-phone"></i> İletişim</button>
                                <button class="action-btn btn-favorite"><i class="far fa-heart"></i></button>
                            </div>
                        </div>
                    </div>

                    <!-- Diğer firma kartları aynı yapıda tekrar edilecek -->

                </div>

                <!-- Sayfalama -->
                <div class="pagination">
                    <button><i class="fas fa-chevron-left"></i></button>
                    <button class="active">1</button>
                    <button>2</button>
                    <button>3</button>
                    <button>4</button>
                    <button>5</button>
                    <button><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Favori butonları için
        document.querySelectorAll('.btn-favorite').forEach(btn => {
            btn.addEventListener('click', function() {
                const icon = this.querySelector('i');
                icon.classList.toggle('far');
                icon.classList.toggle('fas');
                this.classList.toggle('active');
            });
        });

        // Görünüm değiştirme butonları için
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Filtre açılır/kapanır özelliği için
        document.querySelectorAll('.filter-header').forEach(header => {
            header.addEventListener('click', function() {
                const content = this.nextElementSibling;
                const icon = this.querySelector('i');
                content.style.display = content.style.display === 'none' ? 'block' : 'none';
                icon.classList.toggle('fa-chevron-up');
                icon.classList.toggle('fa-chevron-down');
            });
        });
    </script>
    <script>
// Global state yönetimi
	const state = {
	    manufacturers: [],
	    categories: [],
	    filters: {
	        category: '',
	        search: '',
	        priceRange: { min: 0, max: 999999 },
	        location: '',
	        sortBy: 'rating'
	    },
	    view: 'list' // 'list' veya 'grid'
	};
	
	// Sayfa yüklendiğinde çalışacak ana fonksiyon
	document.addEventListener('DOMContentLoaded', async () => {
	    try {
	        // Yükleniyor durumunu göster
	        showLoading();
	
	        // Kategorileri çek
	        const categoryResponse = await fetch('/api/categories');
	        const categoryData = await categoryResponse.json();
	        if(categoryData.success) {
	            state.categories = categoryData.categories;
	            updateCategories(categoryData.categories);
	            setupCategoryFilters();
	        }
	
	        // Üreticileri çek
	        const manufacturerResponse = await fetch('/api/manufacturer/dashboard');
	        const manufacturerData = await manufacturerResponse.json();
	        if(manufacturerResponse.success) {
	            state.manufacturers = manufacturerData.products;
	            updateManufacturerList();
	        }
	
	        // Event listener'ları kur
	        setupEventListeners();
	
	        // Yükleniyor durumunu kaldır
	        hideLoading();
	
	    } catch (error) {
	        console.error('Veri yükleme hatası:', error);
	        showError('Veriler yüklenirken bir hata oluştu');
	        hideLoading();
	    }
	});
	
	// Loading göstergesi
	function showLoading() {
	    const loader = document.createElement('div');
	    loader.id = 'loader';
	    loader.innerHTML = `
	        <div class="loading-spinner">
	            <div class="spinner"></div>
	            <p>Yükleniyor...</p>
	        </div>
	    `;
	    document.body.appendChild(loader);
	}
	
	function hideLoading() {
	    const loader = document.getElementById('loader');
	    if (loader) {
	        loader.remove();
	    }
	}
	
	// Hata mesajı gösterme
	function showError(message, duration = 5000) {
	    const errorDiv = document.createElement('div');
	    errorDiv.className = 'error-message';
	    errorDiv.style.cssText = `
	        position: fixed;
	        top: 20px;
	        right: 20px;
	        background: #ff5722;
	        color: white;
	        padding: 15px 25px;
	        border-radius: 4px;
	        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
	        z-index: 1000;
	        animation: slideIn 0.3s ease-out;
	    `;
	    errorDiv.textContent = message;
	    document.body.appendChild(errorDiv);
	
	    setTimeout(() => {
	        errorDiv.style.animation = 'slideOut 0.3s ease-in';
	        setTimeout(() => errorDiv.remove(), 300);
	    }, duration);
	}
	
	// Başarı mesajı gösterme
	function showSuccess(message, duration = 3000) {
	    const successDiv = document.createElement('div');
	    successDiv.className = 'success-message';
	    successDiv.style.cssText = `
	        position: fixed;
	        top: 20px;
	        right: 20px;
	        background: #4caf50;
	        color: white;
	        padding: 15px 25px;
	        border-radius: 4px;
	        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
	        z-index: 1000;
	        animation: slideIn 0.3s ease-out;
	    `;
	    successDiv.textContent = message;
	    document.body.appendChild(successDiv);
	
	    setTimeout(() => {
	        successDiv.style.animation = 'slideOut 0.3s ease-in';
	        setTimeout(() => successDiv.remove(), 300);
	    }, duration);
	}
	// Event Listener'ları kurma
	function setupEventListeners() {
	    // Arama çubuğu
	    const searchInput = document.querySelector('.search-bar input');
	    if (searchInput) {
	        searchInput.addEventListener('input', debounce(() => {
	            state.filters.search = searchInput.value;
	            updateManufacturerList();
	        }, 300));
	    }
	
	    // Sıralama seçeneği
	    const sortSelect = document.querySelector('.sort-select');
	    if (sortSelect) {
	        sortSelect.addEventListener('change', () => {
	            state.filters.sortBy = sortSelect.value;
	            updateManufacturerList();
	        });
	    }
	
	    // Görünüm değiştirme butonları
	    const viewButtons = document.querySelectorAll('.view-btn');
	    viewButtons.forEach(btn => {
	        btn.addEventListener('click', () => {
	            viewButtons.forEach(b => b.classList.remove('active'));
	            btn.classList.add('active');
	            state.view = btn.querySelector('i').classList.contains('fa-th') ? 'grid' : 'list';
	            updateManufacturerList();
	        });
	    });
	
	    // Fiyat filtresi
	    const priceInputs = document.querySelectorAll('.price-filter input');
	    priceInputs.forEach(input => {
	        input.addEventListener('change', () => {
	            state.filters.priceRange[input.dataset.type] = Number(input.value);
	            updateManufacturerList();
	        });
	    });
	
	    // Kategori filtreleri
	    const categoryCheckboxes = document.querySelectorAll('.checkbox-group input[type="checkbox"]');
	    categoryCheckboxes.forEach(checkbox => {
	        checkbox.addEventListener('change', () => {
	            updateFiltersFromCheckboxes();
	            updateManufacturerList();
	        });
	    });
	
	    // Aktif filtreleri temizleme
	    document.querySelectorAll('.filter-tag i').forEach(closeIcon => {
	        closeIcon.addEventListener('click', (e) => {
	            const filterTag = e.target.parentElement;
	            const filterType = filterTag.dataset.filterType;
	            clearFilter(filterType);
	            updateManufacturerList();
	        });
	    });
	}
	
	// Debounce fonksiyonu
	function debounce(func, wait) {
	    let timeout;
	    return function executedFunction(...args) {
	        const later = () => {
	            clearTimeout(timeout);
	            func(...args);
	        };
	        clearTimeout(timeout);
	        timeout = setTimeout(later, wait);
	    };
	}
	
	// Filtreleme mantığı
	function filterManufacturers(manufacturers) {
	    return manufacturers.filter(manufacturer => {
	        // Arama filtresi
	        if (state.filters.search) {
	            const searchTerm = state.filters.search.toLowerCase();
	            const searchableText = `
	                ${manufacturer.companyName} 
	                ${manufacturer.businessArea} 
	                ${manufacturer.description || ''}
	            `.toLowerCase();
	            
	            if (!searchableText.includes(searchTerm)) {
	                return false;
	            }
	        }
	
	        // Kategori filtresi
	        if (state.filters.category && manufacturer.category !== state.filters.category) {
	            return false;
	        }
	
	        // Fiyat aralığı filtresi
	        if (manufacturer.price) {
	            if (manufacturer.price < state.filters.priceRange.min || 
	                manufacturer.price > state.filters.priceRange.max) {
	                return false;
	            }
	        }
	
	        // Lokasyon filtresi
	        if (state.filters.location && manufacturer.address) {
	            if (!manufacturer.address.toLowerCase().includes(state.filters.location.toLowerCase())) {
	                return false;
	            }
	        }
	
	        return true;
	    });
	}
	
	// Sıralama mantığı
	function sortManufacturers(manufacturers) {
	    return [...manufacturers].sort((a, b) => {
	        switch (state.filters.sortBy) {
	            case 'price-asc':
	                return (a.price || 0) - (b.price || 0);
	            case 'price-desc':
	                return (b.price || 0) - (a.price || 0);
	            case 'rating':
	                return (b.rating || 0) - (a.rating || 0);
	            case 'newest':
	                return new Date(b.createdAt) - new Date(a.createdAt);
	            default:
	                return 0;
	        }
	    });
	}
	
	// Aktif filtreleri güncelleme
	function updateActiveFilters() {
	    const activeFiltersContainer = document.querySelector('.active-filters');
	    if (!activeFiltersContainer) return;
	
	    const activeFilters = [];
	
	    if (state.filters.category) {
	        activeFilters.push({
	            type: 'category',
	            label: `Kategori: ${state.filters.category}`
	        });
	    }
	
	    if (state.filters.search) {
	        activeFilters.push({
	            type: 'search',
	            label: `Arama: ${state.filters.search}`
	        });
	    }
	
	    if (state.filters.location) {
	        activeFilters.push({
	            type: 'location',
	            label: `Konum: ${state.filters.location}`
	        });
	    }
	
	    const filtersHTML = activeFilters.map(filter => `
	        <div class="filter-tag" data-filter-type="${filter.type}">
	            ${filter.label} <i class="fas fa-times"></i>
	        </div>
	    `).join('');
	
	    activeFiltersContainer.innerHTML = filtersHTML;
	}
	
	// Filtre temizleme
	function clearFilter(filterType) {
	    switch (filterType) {
	        case 'category':
	            state.filters.category = '';
	            document.querySelectorAll('.checkbox-group input[type="checkbox"]')
	                .forEach(cb => cb.checked = false);
	            break;
	        case 'search':
	            state.filters.search = '';
	            document.querySelector('.search-bar input').value = '';
	            break;
	        case 'location':
	            state.filters.location = '';
	            document.querySelector('.location-select').value = '';
	            break;
	        case 'all':
	            state.filters = {
	                category: '',
	                search: '',
	                priceRange: { min: 0, max: 999999 },
	                location: '',
	                sortBy: 'rating'
	            };
	            // Tüm form elemanlarını sıfırla
	            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
	            document.querySelector('.search-bar input').value = '';
	            document.querySelector('.sort-select').value = 'rating';
	            break;
	    }
	    updateActiveFilters();
	}
	// Üretici listesini güncelleme
	function updateManufacturerList() {
	    const companyList = document.querySelector('.company-list');
	    if (!companyList) return;
	
	    // Filtreleme ve sıralama uygula
	    let filteredManufacturers = filterManufacturers(state.manufacturers);
	    filteredManufacturers = sortManufacturers(filteredManufacturers);
	
	    // Liste boşsa
	    if (filteredManufacturers.length === 0) {
	        companyList.innerHTML = `
	            <div class="no-results">
	                <i class="fas fa-search" style="font-size: 48px; color: #ccc; margin-bottom: 20px;"></i>
	                <h3>Sonuç Bulunamadı</h3>
	                <p>Arama kriterlerinize uygun sonuç bulunamadı. Lütfen filtrelerinizi değiştirin.</p>
	                <button onclick="clearFilter('all')" class="action-btn btn-primary">
	                    <i class="fas fa-sync"></i> Filtreleri Temizle
	                </button>
	            </div>
	        `;
	        return;
	    }
	
	    // Kartları oluştur
	    const manufacturerHTML = filteredManufacturers.map(manufacturer => `
	        <div class="company-card ${state.view === 'grid' ? 'grid-view' : ''}">
	            <div class="company-header">
	                <h2 class="company-title">${escapeHtml(manufacturer.companyName)}</h2>
	                <div class="company-specs">
	                    <div class="spec-item">
	                        <span class="spec-label">İşleme Kapasitesi</span>
	                        <span class="spec-value">${escapeHtml(manufacturer.businessArea || 'Belirtilmemiş')}</span>
	                    </div>
	                    ${manufacturer.price ? `
	                        <div class="spec-item">
	                            <span class="spec-label">Fiyat</span>
	                            <span class="spec-value">${formatPrice(manufacturer.price)} TL</span>
	                        </div>
	                    ` : ''}
	                    ${manufacturer.category ? `
	                        <div class="spec-item">
	                            <span class="spec-label">Kategori</span>
	                            <span class="spec-value">${escapeHtml(manufacturer.category)}</span>
	                        </div>
	                    ` : ''}
	                </div>
	                <div class="tag-container">
	                    ${manufacturer.certifications ? manufacturer.certifications.map(cert => 
	                        `<span class="cert-tag">${escapeHtml(cert)}</span>`
	                    ).join('') : ''}
	                    ${manufacturer.capabilities ? manufacturer.capabilities.map(cap => 
	                        `<span class="machine-tag">${escapeHtml(cap)}</span>`
	                    ).join('') : ''}
	                </div>
	            </div>
	            <div class="company-footer">
	                <div class="company-info">
	                    ${manufacturer.logo ? `
	                        <img src="${escapeHtml(manufacturer.logo)}" alt="${escapeHtml(manufacturer.companyName)}" 
	                            class="company-logo" onerror="this.src='default-logo.png'">
	                    ` : `
	                        <div class="company-logo-placeholder">
	                            <i class="fas fa-building"></i>
	                        </div>
	                    `}
	                    <div class="company-details">
	                        <span class="company-name">${escapeHtml(manufacturer.companyName)}</span>
	                        <span class="company-location">
	                            <i class="fas fa-map-marker-alt"></i> 
	                            ${escapeHtml(manufacturer.address || 'Konum belirtilmemiş')}
	                        </span>
	                        ${manufacturer.rating ? `
	                            <span class="company-rating">
	                                ${generateStarRating(manufacturer.rating)}
	                                <span class="rating-count">(${manufacturer.ratingCount || 0})</span>
	                            </span>
	                        ` : ''}
	                    </div>
	                </div>
	                <div class="action-buttons">
	                    <button class="action-btn btn-quote" onclick="getTeklif('${manufacturer._id}')">
	                        <i class="fas fa-file-alt"></i> Teklif Al
	                    </button>
	                    <button class="action-btn btn-contact" onclick="contact('${manufacturer._id}')">
	                        <i class="fas fa-phone"></i> İletişim
	                    </button>
	                    <button class="action-btn btn-favorite ${manufacturer.isFavorite ? 'active' : ''}" 
	                            onclick="toggleFavorite(this, '${manufacturer._id}')">
	                        <i class="fa${manufacturer.isFavorite ? 's' : 'r'} fa-heart"></i>
	                    </button>
	                </div>
	            </div>
	        </div>
	    `).join('');
	
	    companyList.innerHTML = manufacturerHTML;
	    updateActiveFilters();
	}
	
	// Yardımcı fonksiyonlar
	function escapeHtml(unsafe) {
	    return unsafe
	        .replace(/&/g, "&amp;")
	        .replace(/</g, "<")
	        .replace(/>/g, ">")
	        .replace(/"/g, "&quot;")
	        .replace(/'/g, "'");
	}
	
	function formatPrice(price) {
	    return new Intl.NumberFormat('tr-TR').format(price);
	}
	
	function generateStarRating(rating) {
	    const fullStars = Math.floor(rating);
	    const hasHalfStar = rating % 1 >= 0.5;
	    const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
	    
	    return `
	        ${Array(fullStars).fill('<i class="fas fa-star"></i>').join('')}
	        ${hasHalfStar ? '<i class="fas fa-star-half-alt"></i>' : ''}
	        ${Array(emptyStars).fill('<i class="far fa-star"></i>').join('')}
	        <span class="rating-value">${rating.toFixed(1)}</span>
	    `;
	}
	
	// İşlem fonksiyonları
	async function getTeklif(manufacturerId) {
	    try {
	        const response = await fetch(`/api/manufacturer/${manufacturerId}/quote`, {
	            method: 'POST',
	            headers: {
	                'Content-Type': 'application/json'
	            }
	        });
	        
	        const data = await response.json();
	        
	        if (data.success) {
	            showSuccess('Teklif talebiniz gönderildi');
	        } else {
	            throw new Error(data.message || 'Teklif talebi gönderilemedi');
	        }
	    } catch (error) {
	        console.error('Teklif hatası:', error);
	        showError('Teklif talebi gönderilirken bir hata oluştu');
	    }
	}
	
	async function contact(manufacturerId) {
	    try {
	        const response = await fetch(`/api/manufacturer/${manufacturerId}/contact`);
	        const data = await response.json();
	        
	        if (data.success) {
	            // İletişim modalını aç
	            openContactModal(data.manufacturer);
	        } else {
	            throw new Error(data.message || 'İletişim bilgileri alınamadı');
	        }
	    } catch (error) {
	        console.error('İletişim hatası:', error);
	        showError('İletişim bilgileri alınırken bir hata oluştu');
	    }
	}
	
	async function toggleFavorite(button, manufacturerId) {
	    try {
	        const response = await fetch(`/api/manufacturer/${manufacturerId}/favorite`, {
	            method: 'POST',
	            headers: {
	                'Content-Type': 'application/json'
	            }
	        });
	        
	        const data = await response.json();
	        
	        if (data.success) {
	            const icon = button.querySelector('i');
	            button.classList.toggle('active');
	            icon.classList.toggle('far');
	            icon.classList.toggle('fas');
	            
	            // State'i güncelle
	            const manufacturer = state.manufacturers.find(m => m._id === manufacturerId);
	            if (manufacturer) {
	                manufacturer.isFavorite = !manufacturer.isFavorite;
	            }
	            
	            showSuccess(data.message);
	        } else {
	            throw new Error(data.message || 'İşlem başarısız');
	        }
	    } catch (error) {
	        console.error('Favori hatası:', error);
	        showError('İşlem sırasında bir hata oluştu');
	    }
	}
	
	// Modal işlemleri
	function openContactModal(manufacturer) {
	    const modal = document.createElement('div');
	    modal.className = 'modal';
	    modal.innerHTML = `
	        <div class="modal-content">
	            <div class="modal-header">
	                <h2>${escapeHtml(manufacturer.companyName)}</h2>
	                <button class="close-btn">&times;</button>
	            </div>
	            <div class="modal-body">
	                <div class="contact-info">
	                    <p><i class="fas fa-phone"></i> ${escapeHtml(manufacturer.phone || 'Telefon bilgisi yok')}</p>
	                    <p><i class="fas fa-envelope"></i> ${escapeHtml(manufacturer.email || 'E-posta bilgisi yok')}</p>
	                    <p><i class="fas fa-map-marker-alt"></i> ${escapeHtml(manufacturer.address || 'Adres bilgisi yok')}</p>
	                </div>
	                <form id="contact-form" class="contact-form">
	                    <input type="text" placeholder="Adınız" required>
	                    <input type="email" placeholder="E-posta Adresiniz" required>
	                    <textarea placeholder="Mesajınız" required></textarea>
	                    <button type="submit" class="action-btn btn-primary">
	                        <i class="fas fa-paper-plane"></i> Mesaj Gönder
	                    </button>
	                </form>
	            </div>
	        </div>
	    `;
	
	    document.body.appendChild(modal);
	
	    // Modal kapatma
	    modal.querySelector('.close-btn').onclick = () => modal.remove();
	    modal.onclick = e => {
	        if (e.target === modal) modal.remove();
	    };
	
	    // Form gönderimi
	    modal.querySelector('#contact-form').onsubmit = async (e) => {
	        e.preventDefault();
	        // Form gönderme işlemleri
	    };
	}
	
	// CSS Animasyonları
	const style = document.createElement('style');
	style.textContent = `
	    @keyframes slideIn {
	        from { transform: translateX(100%); opacity: 0; }
	        to { transform: translateX(0); opacity: 1; }
	    }
	
	    @keyframes slideOut {
	        from { transform: translateX(0); opacity: 1; }
	        to { transform: translateX(100%); opacity: 0; }
	    }
	
	    .loading-spinner {
	        position: fixed;
	        top: 50%;
	        left: 50%;
	        transform: translate(-50%, -50%);
	        z-index: 1000;
	    }
	
	    .spinner {
	        width: 50px;
	        height: 50px;
	        border: 5px solid #f3f3f3;
	        border-top: 5px solid #FF5722;
	        border-radius: 50%;
	        animation: spin 1s linear infinite;
	    }
	
	    @keyframes spin {
	        0% { transform: rotate(0deg); }
	        100% { transform: rotate(360deg); }
	    }
	
	    .modal {
	        position: fixed;
	        top: 0;
	        left: 0;
	        width: 100%;
	        height: 100%;
	        background: rgba(0,0,0,0.5);
	        display: flex;
	        justify-content: center;
	        align-items: center;
	        z-index: 1000;
	    }
	
	    .modal-content {
	        background: white;
	        padding: 20px;
	        border-radius: 8px;
	        width: 90%;
	        max-width: 500px;
	    }
	`;
	
	document.head.appendChild(style);
	</script>
</body>
</html>
