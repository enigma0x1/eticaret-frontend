<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Filtreleme Sistemi</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --background-color: #f8fafc;
            --text-color: #1e293b;
            --gray-light: #e2e8f0;
            --gray-dark: #64748b;
            --white: #ffffff;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        /* Filter Section Styles */
        .filter-section {
            background: var(--white);
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            position: sticky;
            top: 2rem;
            height: calc(100vh - 4rem);
            overflow-y: auto;
        }

        .filter-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .clear-all {
            background: none;
            border: none;
            color: var(--gray-dark);
            cursor: pointer;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Quick Filters */
        .quick-filters {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .quick-filter {
            white-space: nowrap;
            padding: 0.5rem 1rem;
            border: 1px solid var(--gray-light);
            border-radius: 2rem;
            background: var(--white);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-filter.active {
            background: var(--primary-color);
            color: var(--white);
            border-color: var(--primary-color);
        }

        /* Filter Groups */
        .filter-group {
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 1rem;
        }

        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            cursor: pointer;
        }

        .filter-content {
            padding-bottom: 1rem;
        }

        /* Category Grid */
        .category-grid {
            display: grid;
            gap: 0.5rem;
        }

        .category-card {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-card:hover {
            background: var(--gray-light);
        }

        .category-card.active {
            background: #e0f2fe;
            color: var(--primary-color);
        }

        /* Price Slider */
        .price-slider {
            position: relative;
            height: 5px;
            margin: 2rem 0;
        }

        .slider-track {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--gray-light);
            border-radius: 5px;
        }

        .price-inputs {
            display: flex;
            justify-content: space-between;
            gap: 1rem;
        }

        .price-inputs input {
            width: 100px;
            padding: 0.5rem;
            border: 1px solid var(--gray-light);
            border-radius: 0.5rem;
        }

        /* Rating Stars */
        .stars {
            color: #fbbf24;
        }

        .stars i.active {
            color: #fbbf24;
        }

        /* Active Filters */
        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .filter-tag {
            background: #e0f2fe;
            color: var(--primary-color);
            padding: 0.5rem 1rem;
            border-radius: 2rem;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .filter-tag i {
            cursor: pointer;
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .product-card {
            background: var(--white);
            border-radius: 1rem;
            padding: 1rem;
            box-shadow: var(--shadow-sm);
        }

        /* Mobile Styles */
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }

            .filter-section {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                z-index: 1000;
                height: 80vh;
                border-radius: 1rem 1rem 0 0;
                transform: translateY(100%);
                transition: transform 0.3s ease;
            }

            .filter-section.active {
                transform: translateY(0);
            }

            .filter-toggle {
                position: fixed;
                bottom: 1rem;
                right: 1rem;
                width: 50px;
                height: 50px;
                background: var(--primary-color);
                color: var(--white);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                box-shadow: var(--shadow-lg);
                z-index: 999;
                cursor: pointer;
            }
        }
    </style>
</head>
<body>
    <main class="main-content">
        <div class="filter-toggle" id="filterToggle">
            <i class="fas fa-filter"></i>
            <span class="filter-count">0</span>
        </div>

        <section class="filter-section" id="filterSection">
            <div class="filter-section-header">
                <h2>Filtreler</h2>
                <button class="clear-all" id="clearAllFilters">
                    <i class="fas fa-times"></i> Tümünü Temizle
                </button>
            </div>

            <div class="active-filters" id="activeFilters"></div>

            <div class="quick-filters">
                <button class="quick-filter active" data-filter="all">Tümü</button>
                <button class="quick-filter" data-filter="inStock">Stokta</button>
                <button class="quick-filter" data-filter="bestSeller">Çok Satan</button>
                <button class="quick-filter" data-filter="new">Yeni Ürünler</button>
            </div>

            <div class="filter-groups">
                <div class="filter-group">
                    <div class="filter-header">
                        <h3>Kategoriler</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <div class="category-grid" id="categoryGrid"></div>
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-header">
                        <h3>Fiyat Aralığı</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <div class="price-slider">
                            <div class="slider-track"></div>
                            <input type="range" min="0" max="10000" value="0" class="min-price">
                            <input type="range" min="0" max="10000" value="10000" class="max-price">
                        </div>
                        <div class="price-inputs">
                            <input type="number" class="min-input" value="0">
                            <input type="number" class="max-input" value="10000">
                        </div>
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-header">
                        <h3>Format</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <div id="formatFilters"></div>
                    </div>
                </div>

                <div class="filter-group">
                    <div class="filter-header">
                        <h3>Değerlendirme</h3>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="filter-content">
                        <div id="ratingFilters"></div>
                    </div>
                </div>
            </div>
        </section>

        <section class="product-grid" id="productGrid">
            <!-- Ürünler buraya dinamik olarak eklenecek -->
        </section>
    </main>
    <script>
        class FilterManager {
            constructor() {
                this.filters = {
                    category: null,
                    priceRange: { min: 0, max: 10000 },
                    formats: new Set(),
                    rating: null,
                    quickFilter: 'all'
                };
                
                // Örnek ürün verileri
                this.products = [
                    {
                        id: 1,
                        name: "Endüstriyel Robot Kolu",
                        price: 5000,
                        categoryId: 1,
                        formats: ["STL", "STEP"],
                        rating: 4.5,
                        stock: 10,
                        bestSeller: true,
                        isNew: false
                    },
                    {
                        id: 2,
                        name: "CNC Parçası",
                        price: 2500,
                        categoryId: 2,
                        formats: ["OBJ", "STEP"],
                        rating: 3.8,
                        stock: 5,
                        bestSeller: false,
                        isNew: true
                    },
                    // Daha fazla ürün ekleyebilirsiniz
                ];
                
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.initializeFilterGroups();
                this.setupMobileFilters();
                this.setupPriceSlider();
                this.applyFilters(); // İlk yükleme için filtreleri uygula
            }

            setupEventListeners() {
                // Filter Group Toggle
                document.querySelectorAll('.filter-header').forEach(header => {
                    header.addEventListener('click', () => {
                        const content = header.nextElementSibling;
                        const icon = header.querySelector('i');
                        content.style.display = content.style.display === 'none' ? 'block' : 'none';
                        icon.classList.toggle('fa-chevron-up');
                        icon.classList.toggle('fa-chevron-down');
                    });
                });

                // Quick Filters
                document.querySelectorAll('.quick-filter').forEach(btn => {
                    btn.addEventListener('click', () => {
                        document.querySelectorAll('.quick-filter').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.filters.quickFilter = btn.dataset.filter;
                        this.applyFilters();
                    });
                });

                // Clear All Filters
                document.getElementById('clearAllFilters').addEventListener('click', () => {
                    this.clearAllFilters();
                });
            }

            setupMobileFilters() {
                const filterToggle = document.getElementById('filterToggle');
                const filterSection = document.getElementById('filterSection');

                filterToggle?.addEventListener('click', () => {
                    filterSection.classList.toggle('active');
                });
            }

            setupPriceSlider() {
                const minPrice = document.querySelector('.min-price');
                const maxPrice = document.querySelector('.max-price');
                const minInput = document.querySelector('.min-input');
                const maxInput = document.querySelector('.max-input');

                const updateSlider = () => {
                    const min = parseInt(minPrice.value);
                    const max = parseInt(maxPrice.value);
                    
                    minInput.value = min;
                    maxInput.value = max;
                    
                    this.filters.priceRange = { min, max };
                    this.applyFilters();
                };

                [minPrice, maxPrice, minInput, maxInput].forEach(input => {
                    input.addEventListener('input', updateSlider);
                });
            }

            initializeFilterGroups() {
                this.loadCategories();
                this.loadFormatFilters();
                this.loadRatingFilters();
            }

            loadCategories() {
                const categories = [
                    { id: 1, name: 'Endüstriyel Ekipmanlar', icon: 'fa-industry' },
                    { id: 2, name: 'Makine Parçaları', icon: 'fa-cogs' },
                    { id: 3, name: 'Otomasyon Sistemleri', icon: 'fa-robot' }
                ];

                const categoryGrid = document.getElementById('categoryGrid');
                categoryGrid.innerHTML = categories.map(cat => `
                    <div class="category-card" data-category="${cat.id}">
                        <i class="fas ${cat.icon}"></i>
                        <span>${cat.name}</span>
                    </div>
                `).join('');

                categoryGrid.querySelectorAll('.category-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const wasActive = card.classList.contains('active');
                        document.querySelectorAll('.category-card').forEach(c => c.classList.remove('active'));
                        if (!wasActive) {
                            card.classList.add('active');
                            this.filters.category = parseInt(card.dataset.category);
                        } else {
                            this.filters.category = null;
                        }
                        this.applyFilters();
                    });
                });
            }

            loadFormatFilters() {
                const formats = ['STL', 'STEP', 'OBJ'];
                const formatFilters = document.getElementById('formatFilters');
                
                formatFilters.innerHTML = formats.map(format => `
                    <label class="custom-checkbox">
                        <input type="checkbox" value="${format}">
                        <span>${format}</span>
                    </label>
                `).join('');

                formatFilters.querySelectorAll('input').forEach(input => {
                    input.addEventListener('change', () => {
                        if (input.checked) {
                            this.filters.formats.add(input.value);
                        } else {
                            this.filters.formats.delete(input.value);
                        }
                        this.applyFilters();
                    });
                });
            }

            loadRatingFilters() {
                const ratingFilters = document.getElementById('ratingFilters');
                const ratings = [4, 3, 2, 1];

                ratingFilters.innerHTML = ratings.map(rating => `
                    <label class="rating-option">
                        <input type="radio" name="rating" value="${rating}">
                        <div class="stars">
                            ${this.generateStars(rating)}
                        </div>
                        <span>ve üzeri</span>
                    </label>
                `).join('');

                ratingFilters.querySelectorAll('input').forEach(input => {
                    input.addEventListener('change', () => {
                        this.filters.rating = parseInt(input.value);
                        this.applyFilters();
                    });
                });
            }

            generateStars(rating) {
                return Array(5).fill(0).map((_, index) => 
                    `<i class="fas fa-star ${index < rating ? 'active' : ''}"></i>`
                ).join('');
            }

            applyFilters() {
                let filteredProducts = [...this.products];

                // Kategori filtresi
                if (this.filters.category) {
                    filteredProducts = filteredProducts.filter(p => p.categoryId === this.filters.category);
                }

                // Fiyat filtresi
                filteredProducts = filteredProducts.filter(p => 
                    p.price >= this.filters.priceRange.min && 
                    p.price <= this.filters.priceRange.max
                );

                // Format filtresi
                if (this.filters.formats.size > 0) {
                    filteredProducts = filteredProducts.filter(p => 
                        p.formats.some(f => this.filters.formats.has(f))
                    );
                }

                // Değerlendirme filtresi
                if (this.filters.rating) {
                    filteredProducts = filteredProducts.filter(p => p.rating >= this.filters.rating);
                }

                // Quick filtreler
                switch(this.filters.quickFilter) {
                    case 'inStock':
                        filteredProducts = filteredProducts.filter(p => p.stock > 0);
                        break;
                    case 'bestSeller':
                        filteredProducts = filteredProducts.filter(p => p.bestSeller);
                        break;
                    case 'new':
                        filteredProducts = filteredProducts.filter(p => p.isNew);
                        break;
                }

                this.updateActiveFilters();
                this.updateProductGrid(filteredProducts);
            }

            updateActiveFilters() {
                const activeFiltersContainer = document.getElementById('activeFilters');
                const activeFilters = [];

                if (this.filters.category) {
                    const categoryCard = document.querySelector(`.category-card[data-category="${this.filters.category}"]`);
                    if (categoryCard) {
                        activeFilters.push({
                            type: 'category',
                            label: categoryCard.querySelector('span').textContent
                        });
                    }
                }

                if (this.filters.formats.size > 0) {
                    activeFilters.push({
                        type: 'formats',
                        label: `Format: ${Array.from(this.filters.formats).join(', ')}`
                    });
                }

                if (this.filters.rating) {
                    activeFilters.push({
                        type: 'rating',
                        label: `${this.filters.rating}★ ve üzeri`
                    });
                }

                activeFiltersContainer.innerHTML = activeFilters.map(filter => `
                    <div class="filter-tag" data-type="${filter.type}">
                        ${filter.label}
                        <i class="fas fa-times" onclick="filterManager.removeFilter('${filter.type}')"></i>
                    </div>
                `).join('');

                // Update filter count
                const filterCount = document.querySelector('.filter-count');
                if (filterCount) {
                    filterCount.textContent = activeFilters.length;
                }
            }

            removeFilter(type) {
                switch(type) {
                    case 'category':
                        this.filters.category = null;
                        document.querySelectorAll('.category-card').forEach(card => 
                            card.classList.remove('active')
                        );
                        break;
                    case 'formats':
                        this.filters.formats.clear();
                        document.querySelectorAll('#formatFilters input').forEach(input => 
                            input.checked = false
                        );
                        break;
                    case 'rating':
                        this.filters.rating = null;
                        document.querySelectorAll('input[name="rating"]').forEach(input => 
                            input.checked = false
                        );
                        break;
                }
                this.applyFilters();
            }

            clearAllFilters() {
                this.filters = {
                    category: null,
                    priceRange: { min: 0, max: 10000 },
                    formats: new Set(),
                    rating: null,
                    quickFilter: 'all'
                };

                // Reset UI
                document.querySelectorAll('.category-card').forEach(card => 
                    card.classList.remove('active')
                );
                document.querySelectorAll('#formatFilters input').forEach(input => 
                    input.checked = false
                );
                document.querySelectorAll('input[name="rating"]').forEach(input => 
                    input.checked = false
                );
                document.querySelectorAll('.quick-filter').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.filter === 'all') btn.classList.add('active');
                });

                const minPrice = document.querySelector('.min-price');
                const maxPrice = document.querySelector('.max-price');
                const minInput = document.querySelector('.min-input');
                const maxInput = document.querySelector('.max-input');

                minPrice.value = 0;
                maxPrice.value = 10000;
                minInput.value = 0;
                maxInput.value = 10000;

                this.applyFilters();
            }

            updateProductGrid(products) {
                const grid = document.getElementById('productGrid');
                
                if (products.length === 0) {
                    grid.innerHTML = `
                        <div class="no-results">
                            <i class="fas fa-search fa-3x"></i>
                            <p>Sonuç bulunamadı</p>
                        </div>
                    `;
                    return;
                }

                grid.innerHTML = products.map(product => `
                    <div class="product-card">
                        <h3>${product.name}</h3>
                        <p>${product.price} TL</p>
                        <div class="stars">
                            ${this.generateStars(Math.floor(product.rating))}
                        </div>
                        <div class="formats">
                            ${product.formats.join(', ')}
                        </div>
                    </div>
                `).join('');
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            window.filterManager = new FilterManager();
        });
    </script>
</body>
</html>
